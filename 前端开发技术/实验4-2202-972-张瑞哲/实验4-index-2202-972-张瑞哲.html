<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>画图网页</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        #canvas {
            width: 400px;
            height: 400px;
            border: 1px solid #000;
            position: relative;
        }

        .shape {
            position: absolute;
        }
    </style>

    <!-- 引入jQuery库 -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $(document).ready(function () {
            var canvasWidth = $('#canvas').width(); // 获取画布宽度
            var canvasHeight = $('#canvas').height(); // 获取画布高度
            var currentShape = null; // 当前图形元素
            var currentShapeWidth = 0; // 当前图形宽度
            var currentShapeHeight = 0; // 当前图形高度
            var currentLineColor = "#000"; // 当前图形边框颜色
            var currentFillColor = "transparent"; // 当前图形填充颜色
            var motionInterval = null; // 运动间隔
            var motionDirectionX = 1; // 水平运动方向，1为向右，-1为向左
            var motionDirectionY = 1; // 竖直运动方向，1为向下，-1为向上

            // 生成指定范围内的随机整数
            function getRandomInt(min, max) {
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }

            // 绘制长方形
            function drawRectangle() {
                $('.shape').remove(); // 移除所有形状元素
                $('#canvas').append('<div class="shape" id="rectangleShape"></div>'); // 添加长方形元素
                currentShape = $('#rectangleShape'); // 设置当前形状
                currentShapeWidth = 100; // 长方形宽度
                currentShapeHeight = 50; // 长方形高度
                currentShape.css({
                    'width': currentShapeWidth + 'px',
                    'height': currentShapeHeight + 'px',
                    'background-color': currentFillColor,
                    'border': '2px solid ' + currentLineColor
                });
                placeShape(); // 放置形状在画布上
            }

            // 绘制圆形
            function drawCircle() {
                $('.shape').remove();
                $('#canvas').append('<div class="shape rounded-circle" id="circleShape"></div>');
                currentShape = $('#circleShape');
                currentShapeWidth = 100;
                currentShapeHeight = 100;
                currentShape.css({
                    'width': currentShapeWidth + 'px',
                    'height': currentShapeHeight + 'px',
                    'background-color': currentFillColor,
                    'border': '2px solid ' + currentLineColor
                });
                placeShape();
            }

            // 绘制菱形
            function drawDiamond() {
                $('.shape').remove();
                $('#canvas').append('<div class="shape" id="diamondShape"></div>');
                currentShape = $('#diamondShape');
                currentShapeWidth = 100;
                currentShapeHeight = 100;
                currentShape.css({
                    'width': currentShapeWidth + 'px',
                    'height': currentShapeHeight + 'px',
                    'background-color': currentFillColor,
                    'border': '2px solid ' + currentLineColor,
                    'transform': 'rotate(-45deg) skew(-10deg, -10deg)'
                });
                placeShape();
            }

            // 绘制正方形
            function drawSquare() {
                $('.shape').remove();
                $('#canvas').append('<div class="shape" id="squareShape"></div>');
                currentShape = $('#squareShape');
                currentShapeWidth = 100;
                currentShapeHeight = 100;
                currentShape.css({
                    'width': currentShapeWidth + 'px',
                    'height': currentShapeHeight + 'px',
                    'background-color': currentFillColor,
                    'border': '2px solid ' + currentLineColor
                });
                placeShape();
            }

            // 绘制椭圆
            function drawEllipse() {
                $('.shape').remove();
                $('#canvas').append('<div class="shape" id="ellipseShape"></div>');
                currentShape = $('#ellipseShape');
                currentShapeWidth = 150;
                currentShapeHeight = 100;
                currentShape.css({
                    'width': currentShapeWidth + 'px',
                    'height': currentShapeHeight + 'px',
                    'background-color': currentFillColor,
                    'border': '2px solid ' + currentLineColor,
                    'border-radius': '50%'
                });
                placeShape();
            }

            // 在画布上随机放置形状
            function placeShape() {
                var left = getRandomInt(0, canvasWidth - currentShapeWidth);
                var top = getRandomInt(0, canvasHeight - currentShapeHeight);
                if (currentShape.attr('id') === 'diamondShape') {
                    left = getRandomInt(10, canvasWidth - currentShapeWidth - 10);
                    top = getRandomInt(34, canvasHeight - currentShapeHeight - 35);
                }
                currentShape.css({
                    'left': left + 'px',
                    'top': top + 'px'
                });
            }

            // 更改线型
            function changeLineType(type) {
                if (currentShape) {
                    currentShape.css('border-style', type);
                }
            }

            // 更改颜色
            function changeColor(color) {
                currentLineColor = color;
                currentFillColor = color === 'transparent' ? color : color + 'A0';
                if (currentShape) {
                    currentShape.css({
                        'border-color': color,
                        'background-color': currentFillColor
                    });
                }
            }

            // 开始运动
            function startMotion() {
                if (currentShape && !motionInterval) {
                    motionInterval = setInterval(function () {
                        var left = parseInt(currentShape.css('left'));
                        var top = parseInt(currentShape.css('top'));

                        // 检查水平边界
                        if (currentShape.attr('id') === 'diamondShape') {
                            if (left + currentShapeWidth + motionDirectionX >= canvasWidth - 10) {
                                motionDirectionX = -1;
                            } else if (left + motionDirectionX <= 10) {
                                motionDirectionX = 1;
                            }
                        } else {
                            if (left + currentShapeWidth + motionDirectionX >= canvasWidth) {
                                motionDirectionX = -1;
                            } else if (left + motionDirectionX <= 0) {
                                motionDirectionX = 1;
                            }
                        }

                        // 检查竖直边界
                        if (currentShape.attr('id') === 'diamondShape') {
                            if (top + currentShapeHeight + motionDirectionY >= canvasHeight - 35) {
                                motionDirectionY = -1;
                            } else if (top + motionDirectionY <= 34) {
                                motionDirectionY = 1;
                            }
                        } else {
                            if (top + currentShapeHeight + motionDirectionY >= canvasHeight) {
                                motionDirectionY = -1;
                            } else if (top + motionDirectionY <= 0) {
                                motionDirectionY = 1;
                            }
                        }

                        left += motionDirectionX * 5;
                        top += motionDirectionY * 5;

                        currentShape.css({
                            'left': left + 'px',
                            'top': top + 'px'
                        });
                    }, 50);
                }
            }

            // 停止运动
            function stopMotion() {
                if (motionInterval) {
                    clearInterval(motionInterval);
                    motionInterval = null;
                }
            }

            // 绑定长方形点击事件
            $(document).on('click', '#rectangle', function () {
                drawRectangle();
            });

            // 绑定圆形点击事件
            $(document).on('click', '#circle', function () {
                drawCircle();
            });

            // 绑定菱形点击事件
            $(document).on('click', '#diamond', function () {
                drawDiamond();
            });

            // 绑定正方形点击事件
            $(document).on('click', '#square', function () {
                drawSquare();
            });

            // 绑定椭圆点击事件
            $(document).on('click', '#ellipse', function () {
                drawEllipse();
            });

            // 绑定线型按钮点击事件
            $(document).on('click', '#lineType', function () {
                if ($('#lineTypeOptions').length === 0) {
                    $('#colorOptions').remove();
                    $('#motionOptions').remove();
                    $('#options').append('<div id="lineTypeOptions" class="dropdown-menu show">' +
                        '<a class="dropdown-item" href="#" id="solid">实线</a>' +
                        '<a class="dropdown-item" href="#" id="dotted">虚线</a>' +
                        '</div>');
                } else {
                    $('#lineTypeOptions').remove();
                }
            });

            // 绑定颜色按钮点击事件
            $(document).on('click', '#color', function () {
                if ($('#colorOptions').length === 0) {
                    $('#lineTypeOptions').remove();
                    $('#motionOptions').remove();
                    $('#options').append('<div id="colorOptions" class="dropdown-menu show">' +
                        '<a class="dropdown-item" href="#" id="red">红</a>' +
                        '<a class="dropdown-item" href="#" id="green">绿</a>' +
                        '<a class="dropdown-item" href="#" id="blue">蓝</a>' +
                        '</div>');
                } else {
                    $('#colorOptions').remove();
                }
            });

            // 绑定动静按钮点击事件
            $(document).on('click', '#motion', function () {
                if ($('#motionOptions').length === 0) {
                    $('#lineTypeOptions').remove();
                    $('#colorOptions').remove();
                    $('#options').append('<div id="motionOptions" class="dropdown-menu show">' +
                        '<a class="dropdown-item" href="#" id="dynamic">动</a>' +
                        '<a class="dropdown-item" href="#" id="static">静</a>' +
                        '</div>');
                } else {
                    $('#motionOptions').remove();
                }
            });

            // 绑定实线按钮点击事件
            $(document).on('click', '#solid', function () {
                changeLineType('solid');
            });

            // 绑定虚线按钮点击事件
            $(document).on('click', '#dotted', function () {
                changeLineType('dotted');
            });

            // 绑定红色按钮点击事件
            $(document).on('click', '#red', function () {
                changeColor('red');
            });

            // 绑定绿色按钮点击事件
            $(document).on('click', '#green', function () {
                changeColor('green');
            });

            // 绑定蓝色按钮点击事件
            $(document).on('click', '#blue', function () {
                changeColor('blue');
            });

            // 绑定动态运动按钮点击事件
            $(document).on('click', '#dynamic', function () {
                startMotion();
            });

            // 绑定静态按钮点击事件
            $(document).on('click', '#static', function () {
                stopMotion();
            });

            // 绑定键盘事件，按下b键颜色改为蓝色，按下r键颜色改为红色
            $(document).keydown(function (event) {
                if (event.key === 'b') {
                    changeColor('blue');
                } else if (event.key === 'r') {
                    changeColor('red');
                }
            });
        });
    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="#" id="rectangle">长方形</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" id="circle">圆</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" id="diamond">菱形</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" id="square">正方形</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" id="ellipse">椭圆</a>
            </li>
        </ul>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col">
                <div class="btn-group-vertical" id="options">
                    <button type="button" class="btn btn-primary" id="lineType">线型</button>
                    <button type="button" class="btn btn-primary" id="color">颜色</button>
                    <button type="button" class="btn btn-primary" id="motion">动静</button>
                </div>
            </div>
            <div class="col">
                <div id="canvas"></div>
            </div>
        </div>
    </div>

</body>

</html>